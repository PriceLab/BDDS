m
m <- data.frame(word.1 = rep(1:10,10), word.2 = rep(1:5,20))
m
head(m)
head(m,21)
library(dplyr)
library(dplyr)
?summarize
?count
?summarize
summarize(m)
summarize(m,count)
?group_by
group_by(m, word.1,word.2)
group_by(m, word.1,word.2,add=TRUE)
?summarize
summarize(group_by(m, word.1))
summarize(m, word.1)
summarize(m, count(word.1))
summarize(m, word.1)
m <- data.frame(word.1 = rep(1:10,10), word.2 = rep(1:5,20),counts = rep(1,100))
head(m)
?ddply
library(plyr)
?ddply
?numcolwise
?aggregate
test <- ddply(m, "word.2",numcolwise(sum))
test
?ddply
test <- ddply(m, c("word.1","word.2"),numcolwise(sum))
test
m <- data.frame(word.1 = rep(1:10,10), word.2 = rep(1:5,20),word.3 = rep(1:2, 50), word.4 = rep(1:20, 5),counts = rep(1,100))
test <- ddply(m, c("word.1","word.2","word.3","word.4"),numcolwise(sum))
head(test)
test
?solve
knitr::opts_chunk$set(echo = TRUE)
library(TReNA)
genome.db.uri    <- "postgres://bddsrds.globusgenomics.org/hg38"  # has gtf and motifsgenes tables
footprint.db.uri <- "postgres://bddsrds.globusgenomics.org/brain_hint"  # has hits and regions tables
fpf <- FootprintFinder(genome.db.uri, footprint.db.uri, quiet=FALSE)
BiocInstaller::biocLite("dbplyr")
mayo.tcx <- readRDS("./mayo-tcx/mayo.tcx.rds")
setwd("~/Documents/Cory_stuff")
mayo.tcx <- readRDS("./mayo-tcx/mayo.tcx.rds")
mayo.cer <- readRDS("./mayo-cer/mayo.cer.rds")
mayo.tcx <- mayo.tcx %>%
group_by(target.gene) %>%
mutate(rank.tcx = rank(-pcaMax))
library(dplyr)
mayo.tcx <- mayo.tcx %>%
group_by(target.gene) %>%
mutate(rank.tcx = rank(-pcaMax))
head(mayo.tcx)
class(mayo.tcx)
class(table(1:20))
biocLite()
BiocInstaller::biocLite()
BiocInstaller::biocLite("DBI")
BiocInstaller::biocLite("RSQLite")
knitr::opts_chunk$set(echo = TRUE)
library(MotifDb); library(dplyr)
all.motifs <- subset(MotifDb, dataSource %in% c("HOCOMOCOv10","jaspar2016"))
all.motifs <- subset(all.motifs, organism %in% c("Hsapiens","Mmusculus"))
length(all.motifs)
setwd("~/Documents/Github/BDDS/trenadb/fimo")
human.hoco <- read.table(file = "./TOMTOM/hocomoco_jaspar_human/tomtom.txt")
mouse.hoco <- read.table(file = "./TOMTOM/hocomoco_jaspar_mouse/tomtom.txt")
all.hoco <- rbind(human.hoco,mouse.hoco)
names(all.hoco) <- c("Query.ID", "Target.ID", "Optimal.offset", "Pvalue","Evalue","Qvalue","Overlap","Query.consensus","Target.consensus","Orientation")
dim(all.hoco)
all.hoco <- select(all.hoco, Query.ID, Target.ID, Pvalue)
dim(all.hoco)
all.hoco <- select(all.hoco, Query.ID, Target.ID, Pvalue)
head(all.hoco)
all.hoco <- all.hoco %>%
select(Query.ID, Target.ID, Pvalue) %>%
mutate(logP = -1*log10(Pvalue))
head(all.hoco)
above.p <- all.hoco %>% filter(logP >= 7.3)
repeat.motifs <- unique(above.p$Query.ID)
length(repeat.motifs)
trimmed.repeats <- gsub(".+HOCOMOCOv10-","",repeat.motifs)
fimo.motifs <- subset(all.motifs, !(providerId %in% trimmed.repeats))
length(fimo.motifs)
df1 <- data.frame(beta.lasso = 1:6, pcaMax = rnorm(6))
df
df1
df2 <- data.frame(beta.lasso = 2:7, pcaMax = rnorm(6))
df2
library(dplyr)
df2 <- data.frame(gene=letters[1:6],beta.lasso = 2:7, pcaMax = rnorm(6))
df1 <- data.frame(gene=letters[1:6],beta.lasso = 1:6, pcaMax = rnorm(6))
df2
df3 <- full_join(df1,df2, by = "gene")
df3
df2 - df1
abs(df2 - df1)
abs(df2[,c(-gene)] - df1[,c(-gene)])
abs(df2[,c(-gene)] - df1[,c(-gene)])
df2[,c(-gene)]
df2
df2[,c(-1)]
abs(df2[,c(-1)] - df1[,c(-1)])
table(values(all.motifs)$dataSource)
table(values(all.motifs)$dataSource)
colnames (values (MotifDb))
head(values(all.motifs)$geneSymbol)
head(values(all.motifs)$geneID)
head(values(all.motifs$providerName))
colnames (values (all.motifs))
head(values(all.motifs)$providerName)
head(values(all.motifs)$geneSymbol)
head(values(all.motifs)$providerID)
head(values(all.motifs)$providerId)
head(values(all.motifs)$geneId)
asset.7 <- data.frame(motifs = values(all.motifs)$providerName,
TFs = values(all.motifs)$geneSymbol)
head(asset.7)
asset.7 <- data.frame(motifs = values(all.motifs)$providerName,
TFs = values(all.motifs)$geneSymbol)
head(asset.7); dim(asset.7)
head(all.hoco)
head(above.p)
dim(above.p)
above.p$Query.ID <- gsub(".+HOCOMOCOv10-","",above.p$Query.ID)
above.p$Target.ID <- gsub(".+jaspar2016-","",above.p$Target.ID)
head(above.p)
above.p$Query.ID <- gsub(".+HOCOMOCOv10-","",above.p$Query.ID)
above.p$Target.ID <- gsub(".+jaspar2016-","",above.p$Target.ID)
above.p <- select(above.p, Query.ID, Target.ID); head(above.p)
fimo.TFs <- data.frame(motifs = values(all.motifs)$providerName,
TFs = values(all.motifs)$geneSymbol)
head(fimo.TFs); dim(fimo.TFs)
fimo.TFs <- data.frame(motifs = values(fimo.motifs)$providerName,
TFs = values(fimo.motifs)$geneSymbol)
head(fimo.TFs); dim(fimo.TFs)
?left_join
final.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
above.p$Query.ID <- gsub(".+HOCOMOCOv10-","",above.p$Query.ID)
above.p$Target.ID <- gsub(".+jaspar2016-","",above.p$Target.ID)
asset.8 <- select(above.p, Query.ID, Target.ID); head(above.p)
above.p$Query.ID <- gsub(".+HOCOMOCOv10-","",above.p$Query.ID)
above.p$Target.ID <- gsub(".+jaspar2016-","",above.p$Target.ID)
asset.8 <- select(above.p, Query.ID, Target.ID); head(asset.8)
final.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
head(final.mapping)
final.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
head(final.mapping)
prelim.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
head(final.mapping)
prelim.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
head(prelim.mapping);dim(prelim.mapping)
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
dim(final.mapping)
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
head(final.mapping);dim(final.mapping)
length(duplicated(final.mapping))
sum(duplicated(final.mapping))
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping)
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
head(final.mapping);dim(final.mapping)
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping)
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping); head(final.mapping)
length(unique(final.mapping$motifs))
tail(unique(final.mapping$motifs))
head(unique(final.mapping$motifs))
length(unique(asset.8$Target.ID))
tail(unique(asset.8$Target.ID))
length(unique(fimo.TFs$motifs))
tail(unique(fimo.TFs$motifs))
tail(unique(fimo.TFs$motifs),30)
tail(unique(fimo.TFs$motifs),50)
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], as.character(fimo.TFs))
head(final.mapping);dim(final.mapping)
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping); head(final.mapping)
length(unique(final.mapping$motifs))
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
head(final.mapping);dim(final.mapping)
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping); head(final.mapping)
length(unique(final.mapping$motifs))
above.p <- all.hoco %>% filter(logP >= 7.3)
above.p$Query.ID <- as.character(above.p$Query.ID)
above.p$Target.ID <- as.character(above.p$Target.ID)
repeat.motifs <- unique(above.p$Query.ID)
length(repeat.motifs)
trimmed.repeats <- gsub(".+HOCOMOCOv10-","",repeat.motifs)
fimo.motifs <- subset(all.motifs, !(providerId %in% trimmed.repeats))
length(fimo.motifs)
colnames (values (all.motifs))
head(values(all.motifs)$providerName)
head(values(all.motifs)$geneSymbol)
asset.7 <- data.frame(motifs = values(all.motifs)$providerName,
TFs = values(all.motifs)$geneSymbol)
head(asset.7); dim(asset.7)
asset.7 <- data.frame(motifs = as.character(values(all.motifs)$providerName),
TFs = as.character(values(all.motifs)$geneSymbol))
head(asset.7); dim(asset.7)
m1 <- prelim.mapping$motifs
m2 <- fimo.TFs$motifs
length(m1)
length(m2)
class(m1)
class(m2)
length(intersect(m1,m2))
length(intersect(as.factor(m1),m2))
head(m1)
head(m2)
m2 <- as.character(m2)
length(intersect(m1,m2))
tail(final.mapping$motifs)
jaspar <- query(MotifDb, "jaspar2016")
head(values(jaspar)$providerId)
jaspar <- query(MotifDb, "jaspar2016")
head(values(jaspar)$providerId)
jaspar <- subset(all.motifs, "jaspar2016")
head(values(jaspar)$providerId)
head(all.motifs)
jaspar <- query(all.motifs, "jaspar2016")
head(values(jaspar)$providerId)
length(unique(final.mapping$motifs))
knitr::opts_chunk$set(echo = TRUE)
library(MotifDb); library(dplyr)
all.motifs <- subset(MotifDb, dataSource %in% c("HOCOMOCOv10","jaspar2016"))
all.motifs <- subset(all.motifs, organism %in% c("Hsapiens","Mmusculus"))
length(all.motifs)
human.hoco <- read.table(file = "./TOMTOM/hocomoco_jaspar_human/tomtom.txt")
mouse.hoco <- read.table(file = "./TOMTOM/hocomoco_jaspar_mouse/tomtom.txt")
all.hoco <- rbind(human.hoco,mouse.hoco)
names(all.hoco) <- c("Query.ID", "Target.ID", "Optimal.offset", "Pvalue","Evalue","Qvalue","Overlap","Query.consensus","Target.consensus","Orientation")
dim(all.hoco)
all.hoco <- all.hoco %>%
select(Query.ID, Target.ID, Pvalue) %>%
mutate(logP = -1*log10(Pvalue))
head(all.hoco)
above.p <- all.hoco %>% filter(logP >= 7.3)
above.p$Query.ID <- as.character(above.p$Query.ID)
above.p$Target.ID <- as.character(above.p$Target.ID)
repeat.motifs <- unique(above.p$Query.ID)
length(repeat.motifs)
trimmed.repeats <- gsub(".+HOCOMOCOv10-","",repeat.motifs)
fimo.motifs <- subset(all.motifs, !(providerId %in% trimmed.repeats))
length(fimo.motifs)
colnames (values (all.motifs))
head(values(all.motifs)$providerName)
head(values(all.motifs)$geneSymbol)
asset.7 <- data.frame(motifs = as.character(values(all.motifs)$providerName),
TFs = as.character(values(all.motifs)$geneSymbol))
head(asset.7); dim(asset.7)
fimo.TFs <- data.frame(motifs = values(fimo.motifs)$providerName,
TFs = values(fimo.motifs)$geneSymbol)
head(fimo.TFs); dim(fimo.TFs)
head(above.p); dim(above.p)
above.p$Query.ID <- gsub(".+HOCOMOCOv10-","",above.p$Query.ID)
above.p$Target.ID <- gsub(".+jaspar2016-.+-","",above.p$Target.ID)
asset.8 <- select(above.p, Query.ID, Target.ID); head(asset.8)
prelim.mapping <- left_join(asset.8,asset.7, by = c("Query.ID" = "motifs"))
head(prelim.mapping);dim(prelim.mapping)
names(prelim.mapping)[2] <- "motifs"
final.mapping <- rbind(prelim.mapping[,2:3], fimo.TFs)
head(final.mapping);dim(final.mapping)
final.mapping <- final.mapping[!duplicated(final.mapping),]
dim(final.mapping); head(final.mapping)
length(unique(final.mapping$motifs))
length(unique(final.mapping$TFs))
final.mappings %>% group_by(motif) %>% summarize(TFs = n())
final.mapping %>% group_by(motif) %>% summarize(TFs = n())
final.mapping %>% group_by(motifs) %>% summarize(TFs = n())
final.mapping %>% group_by(motifs) %>% summarize(TFs = n()) %>% arrange(desc(TFs))
final.mapping %>% filter(motifs == "MA0894.1")
final.mapping %>% group_by(TFs) %>% summarize(motifs = n()) %>% arrange(desc(motifs))
library(ggplot2)
final.mapping %>% group_by(TFs) %>% summarize(motifs = n()) %>% arrange(desc(motifs)) %>% ggplot(aes(x=motifs)) + geom_histogram()
final.mapping %>% group_by(TFs) %>% summarize(motifs = n()) %>% arrange(desc(motifs)) %>% ggplot(aes(x=motifs)) + geom_histogram(bins = 15)
final.mapping %>% group_by(TFs) %>% summarize(motifs = n()) %>% arrange(desc(motifs)) %>% ggplot(aes(x=motifs)) + geom_histogram(bins = 17)
final.mapping %>% group_by(motifs) %>% summarize(TFs = n()) %>% arrange(desc(TFs)) %>% ggplot(aes(x=TFs)) + geom_histogram(bins = 12)
library(TReNA)
blah <- system.file(package="TReNA", "extdata", "motifGenes.tsv”)
)
""
"
blah <- system.file(package="TReNA", "extdata", "motifGenes.tsv")
head(blah)
blah <- load(system.file(package="TReNA", "extdata", "motifGenes.tsv"))
blah <- read.table(system.file(package="TReNA", "extdata", "motifGenes.tsv"))
blah <- read.table(system.file(package="TReNA", "extdata", "motifGenes.tsv"), sep = "\t")
head(blah)
seth.table <- blah
blah <- read.table(system.file(package="TReNA", "extdata", "motifGenes.tsv"), sep = "\t", header = TRUE)
head(blah)
seth.table <- read.table(system.file(package="TReNA", "extdata", "motifGenes.tsv"), sep = "\t", header=TRUE)
head(seth.table)
length(unique(seth.table$motif))
length(unique(seth.table$tf.gene))
length(unique(final.mapping$TFs))
seth.table %>% group_by(motif) %>% summarize(TFs=n()) %>% arrange(desc(TFs))
filter(final.mapping, motifs == "MA0640.1")
filter(seth.table, motifs == "MA0640.1")
filter(seth.table, motif == "MA0640.1")
seth.table %>% group_by(motif) %>% summarize(TFs=n()) %>% arrange(desc(TFs)) %>% ggplot(aes(x=motif)) + geom_histogram()
seth.table %>% group_by(motif) %>% summarize(TFs=n()) %>% arrange(desc(TFs)) %>% ggplot(aes(x=TFs)) + geom_histogram()
seth.table %>% group_by(motif) %>% summarize(TFs=n()) %>% arrange(desc(TFs)) %>% ggplot(aes(x=TFs)) + geom_histogram(bins = 66)
length(intersect(final.mapping$TFs, seth.table$tf.gene))
browseVignettes("BiocParallel")
final.mapping %>% filter(TFs == "TWIST1")
seth.table %>% filter(TFs == "TWIST1")
seth.table %>% filter(tf.gene == "TWIST1")
head(final.mapping)
final.mapping %>% filter(TFs == "TWIST1")
final.mapping %>% filter(TFs == "TWIST2")
final.mapping %>% filter(TFs == "Twist2")
final.mapping %>% filter(TFs == "Twist1")
seth.table %>% filter(TFs == "Twist1")
seth.table %>% filter(tf.gene == "Twist1")
final.mapping %>% filter(TFs == "Twist2")
final.mapping %>% filter(motifs == "MA0633.1")
length(unique(seth.table$tf.gene))
length(unique(final.mapping$TFs))
length(unique(setdiff(seth.table$tf.gene, final.mapping$TFs)))
library(RPostgreSQL)
sessionInfo()
library(BiocInstaller)
biocLite("RPostgreSQL")
data(mtcars)
mtcars
head(mtcars)
?lm
lm(mpg~.)
lm(mpg~., data=mtcars)
fit <- lm(mpg~., data=mtcars)
summary(fit)
fit <- lm(mpg~wt, data=mtcars)
summary(fit)
str(fit)
fit <- lm(mpg~wt+hp, data=mtcars)
summary(fit)
fit <- lm(mpg~., data=mtcars)
summary(fit)
with(mtcars, plot(cyl, hp))
with(mtcars, plot(disp, hp))
fit <- lm(mpg~disp+hp, data=mtcars)
summary(fit)
fit <- lm(mpg~disp*hp, data=mtcars)
summary(fit)
seth.table <- read.table(system.file(package="TReNA", "extdata", "motifGenes.tsv"), sep = "\t", header=TRUE)
dim(seth.table)
length(unique(seth.table$motif))
final.mapping %>%
group_by(motifs) %>%
summarize(TFs = n()) %>%
arrange(desc(TFs)) %>%
ggplot(aes(x=TFs)) + geom_histogram(bins = 12)
final.mapping %>%
group_by(TFs) %>%
summarize(motifs = n()) %>%
arrange(desc(motifs)) %>%
ggplot(aes(x=motifs)) + geom_histogram(bins = 17)
head(seth.table)
head(final.mapping)
length(intersect(final.mapping$motifs, seth.table$motif))
length(unique(seth.table$motif))
length(setdiff(seth.table$motif,final.mapping$motifs))
not.there <- setdiff(seth.table$motif,final.mapping$motifs)
head(not.there)
tail(not.there)
tail(not.there,30)
not.there
library(MotifDb)
test <- subset(MotifDb, providerId %in% not.there)
test
test2 <- query(test, "jaspar2016")
test2
test <- query(MotifDb,"Rnorvegicus")
length(test)
test <- query(MotifDb,"jaspar2016")
length(test)
test <- query(query(MotifDb,"jaspar2016"), "hsapiens")
length(test)
test <- query(query(MotifDb,"jaspar2016"), "mmusculus")
length(test)
table(values(test)$organism)
table(values(test2)$organism)
table(values(query(MotifDb,"jaspar2016"))$organism)
other.vertebrates <- c("Ggallus","Ocuniculus","Rnorvegicus","Rrattus","Xlaevis")
motif <- query(MotifDb, "MA0624.1")
motif
values(motif)
?bis
mtcars
target <- "mpg"
fit <- lm(target~., data=mtcars)
fit <- lm(paste0(target,"~."), data=mtcars)
summary(fit)
library(MotifDb)
length(query(MotifDb, "jaspar2016"))
pwd()
getwd()
breast.cancer <- read.csv("/Users/mrichard/Documents/Github/FH_intermediate_R/Datasets/breastcancerdata.csv")
head(breast.cancer)
summary(breast.cancer)
?ifelse
breast.cancer$mal <- ifelse(X2.1 == 2, "Benign", "Malignant")
breast.cancer$mal <- ifelse(breast.cancer$X2.1 == 2, "Benign", "Malignant")
head(breast.cancer)
summary(breast.cancer)
breast.cancer$mal <- as.factor(breast.cancer$mal)
summary(breast.cancer)
knitr::opts_chunk$set(echo = TRUE)
fruit <- c("apple","banana","orange","lemon","durian")
switch(fruit,
"apple" = "red",
"banana" = "yellow",
"durian" = "brown"
"orange" = "orange")
fruit <- c("apple","banana","orange","lemon","durian")
switch(fruit,
"apple" = "red",
"banana" = "yellow",
"durian" = "brown",
"orange" = "orange")
fruit <- c("apple","banana","orange","lemon","durian")
switch(fruit[1],
"apple" = "red",
"banana" = "yellow",
"durian" = "brown",
"orange" = "orange")
fruit <- c("apple", "banana")
color <- switch(fruit[1],
"apple" = "red",
"banana" = "yellow",
"durian" = "brown",
"orange" = "orange")
color
x <- 1:3
ifelse(x >= 2, "Big","Little")
switch(4, "<5" = "little", ">=5" = "big")
blah <- switch(4, "<5" = "little", ">=5" = "big")
blah
blah <- switch(4, <5 = "little", ">=5" = "big")
?rpois
rpois(10)
?rnorm
rnorm(1)
round(23.5)
round(23.4)
ceiling(0.1)
ceiling(24*abs(rnorm(1)))
ceiling(24*abs(rnorm(1)))
ceiling(24*abs(rnorm(1)))
ceiling(24*abs(rnorm(1)))
ceiling(24*abs(rnorm(1)))
runif(1)
sample(1:24)
?sample
sample(1:24, 1)
sample(1:24, 1)
sample(1:24, 1)
l <- NULL
class(l)
as.numeric(l)
l <- as.numeric(l)
isEmpty(l)
rep(1, 3)
strsplit("hi there", split=" ")
blah <- c("One","two")
summary(blah)
?apply
knitr::opts_chunk$set(echo = TRUE)
M <- matrix(1:10,nrow=2)
apply(M, 2, *)
?sum
M <- matrix(1:10,nrow=2)
apply(M, 2, prod)
print(M)
apply(M, 2, prod)
M <- matrix(1:10,nrow=2)
print(M)
apply(M, 2, prod)
M <- matrix(1:10,nrow=2)
M
apply(M, 2, prod)
?tapply
set.seed(11)
patients <- data.frame(state = sample(c("Healthy","Infected"),20),
age = sample(30:50, 20))
set.seed(11)
patients <- data.frame(state = sample(c("Healthy","Infected"),20, replace = TRUE),
age = sample(30:50, 20, replace = TRUE))
patients
tapply(patients, state, median)
tapply(patients, patients$state, median)
tapply(patients$age, patients$state, median)
tapply(patients$age, patients$state, mean)
split()
?split
split.patients <- split(patients, patients$state)
lapply(split.patients$age, mean)
str(split.patients)
split.patients <- split(patients$age, patients$state)
lapply(split.patients, mean)
