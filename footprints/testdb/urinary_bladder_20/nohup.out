CREATE DATABASE
GRANT
CREATE DATABASE
GRANT
You are now connected to database "urinary_bladder_wellington_20" as user "trena".
CREATE TABLE
GRANT
CREATE TABLE
GRANT
You are now connected to database "urinary_bladder_hint_20" as user "trena".
CREATE TABLE
GRANT
CREATE TABLE
GRANT

R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # users can either step through this file, or call this file with 
> # r -f example.R
> 
> # THIS ASSUMES THAT THE TESTHINT DATABASE EXISTS. The recipe for building that
> # database is in ../dbInitialization/createHintTest.sql
> 
> # THIS EXAMPLE USES THE BRAIN HINT OUTPUT MADE BY RUNNING make hint at /scratch/data/footprints
> 
> print(date())
[1] "Fri Aug 11 13:48:30 2017"
> #-------------------------------------------------------------------------------
> # set path to hint output 
> data.path <- "/ssd/mrichard/data/footprints/urinary_bladder_hint_20"
> #-------------------------------------------------------------------------------
> # establish database connections:
> 
> if(!exists("db.hint"))
+     db.hint <- "urinary_bladder_hint_20_localhost"
> 
> if(!exists("db.fimo"))
+     db.fimo <- "fimo_localhost"
> #-------------------------------------------------------------------------------
> # Source the libraries
> source("../src/dependencies.R")
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:parallel’:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, append, as.data.frame, cbind, colMeans, colnames,
    colSums, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, lengths, Map, mapply, match,
    mget, order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following object is masked from ‘package:base’:

    expand.grid

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: DBI
> source("../src/dbFunctions.R")
> source("../src/tableParsing.R")
> source("../src/tests.R")
> source("../src/main_Bioc.R")
> 
> if(!interactive()){    
+     chromosomes <- paste0("chr",1:10)
+     
+     # Create parallel structure here    
+     library(BiocParallel)    
+     register(MulticoreParam(workers = 10, stop.on.error = FALSE, log = TRUE), default = TRUE)
+ 
+     # Run on all 24 possible chromosomes at once
+     result <- bptry(bplapply(chromosomes,fillAllSamplesByChromosome,
+              dbConnection = db.hint,             
+              fimo = db.fimo,             
+              minid = "urinary_bladder_hint_20.minid",             
+              dbUser = "trena",             
+              dbTable = "urinary_bladder_hint_20",             
+              sourcePath = data.path,             
+              isTest = FALSE,             
+              method = "HINT"))    
+ }
############### LOG OUTPUT ###############
Task: 10
Node: 10
Timestamp: 2017-08-11 14:02:54
Success: TRUE
Task duration:
   user  system elapsed 
405.008 139.024 849.820 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1645568 87.9    2637877 140.9  1850597 98.9
Vcells 1726214 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr10) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 720208 regions, 1168234 hits for ENCSR813CKU
[1] 1168234 hits in 720208 regions
############### LOG OUTPUT ###############
Task: 9
Node: 9
Timestamp: 2017-08-11 14:04:23
Success: TRUE
Task duration:
   user  system elapsed 
384.800 132.648 940.043 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646552 88.0    2637877 140.9  1850597 98.9
Vcells 1728707 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr9) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 674192 regions, 1104535 hits for ENCSR813CKU
[1] 2272769 hits in 1394400 regions
############### LOG OUTPUT ###############
Task: 8
Node: 8
Timestamp: 2017-08-11 14:05:10
Success: TRUE
Task duration:
   user  system elapsed 
416.944 148.356 986.068 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646553 88.0    2637877 140.9  1850597 98.9
Vcells 1728708 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr8) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 649144 regions, 1053911 hits for ENCSR813CKU
[1] 3326680 hits in 2043544 regions
############### LOG OUTPUT ###############
Task: 7
Node: 7
Timestamp: 2017-08-11 14:11:19
Success: TRUE
Task duration:
    user   system  elapsed 
 521.472  221.092 1326.598 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646554 88.0    2637877 140.9  1850597 98.9
Vcells 1728709 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr7) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 752345 regions, 1231292 hits for ENCSR813CKU
[1] 4557972 hits in 2795889 regions
############### LOG OUTPUT ###############
Task: 6
Node: 6
Timestamp: 2017-08-11 14:13:38
Success: TRUE
Task duration:
    user   system  elapsed 
 600.248  228.032 1486.465 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646555 88.0    2637877 140.9  1850597 98.9
Vcells 1728710 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr6) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 811480 regions, 1314814 hits for ENCSR813CKU
[1] 5872786 hits in 3607369 regions
############### LOG OUTPUT ###############
Task: 4
Node: 4
Timestamp: 2017-08-11 14:14:22
Success: TRUE
Task duration:
    user   system  elapsed 
 628.412  228.544 1530.475 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646556 88.0    2637877 140.9  1850597 98.9
Vcells 1728711 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr4) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 649725 regions, 1047499 hits for ENCSR813CKU
[1] 6920285 hits in 4257094 regions
############### LOG OUTPUT ###############
Task: 5
Node: 5
Timestamp: 2017-08-11 14:15:36
Success: TRUE
Task duration:
    user   system  elapsed 
 566.448  251.900 1600.076 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646557 88.0    2637877 140.9  1850597 98.9
Vcells 1728712 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr5) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 736835 regions, 1192677 hits for ENCSR813CKU
[1] 8112962 hits in 4993929 regions
############### LOG OUTPUT ###############
Task: 3
Node: 3
Timestamp: 2017-08-11 14:17:56
Success: TRUE
Task duration:
    user   system  elapsed 
 713.440  254.176 1747.470 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646558 88.0    2637877 140.9  1850597 98.9
Vcells 1728713 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr3) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 869919 regions, 1411382 hits for ENCSR813CKU
[1] 9524344 hits in 5863848 regions
############### LOG OUTPUT ###############
Task: 2
Node: 2
Timestamp: 2017-08-11 14:19:45
Success: TRUE
Task duration:
    user   system  elapsed 
 729.908  287.064 1856.466 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646559 88.0    2637877 140.9  1850597 98.9
Vcells 1728714 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr2) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 1157539 regions, 1876681 hits for ENCSR813CKU
[1] 11401025 hits in 7021387 regions
############### LOG OUTPUT ###############
Task: 1
Node: 1
Timestamp: 2017-08-11 14:22:44
Success: TRUE
Task duration:
    user   system  elapsed 
 815.648  351.732 2032.253 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646560 88.0    2637877 140.9  1850597 98.9
Vcells 1728715 13.2    3142662  24.0  2552207 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr1) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 1466150 regions, 2399449 hits for ENCSR813CKU
[1] 13800474 hits in 8487537 regions
> 
> print(bpok(result))
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
> print("Database fill complete")
[1] "Database fill complete"
> print(date())
[1] "Fri Aug 11 14:22:44 2017"
> 

R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # users can either step through this file, or call this file with 
> # r -f example.R
> 
> # THIS ASSUMES THAT THE TESTHINT DATABASE EXISTS. The recipe for building that
> # database is in ../dbInitialization/createHintTest.sql
> 
> # THIS EXAMPLE USES THE BRAIN HINT OUTPUT MADE BY RUNNING make hint at /scratch/data/footprints
> 
> print(date())
[1] "Fri Aug 11 16:02:21 2017"
> #-------------------------------------------------------------------------------
> # set path to hint output 
> data.path <- "/ssd/mrichard/data/footprints/urinary_bladder_hint_20"
> #-------------------------------------------------------------------------------
> # establish database connections:
> 
> if(!exists("db.hint"))
+     db.hint <- "urinary_bladder_hint_20_localhost"
> 
> if(!exists("db.fimo"))
+     db.fimo <- "fimo_localhost"
> #-------------------------------------------------------------------------------
> # Source the libraries
> source("../src/dependencies.R")
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:parallel’:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, append, as.data.frame, cbind, colMeans, colnames,
    colSums, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, lengths, Map, mapply, match,
    mget, order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following object is masked from ‘package:base’:

    expand.grid

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: DBI
> source("../src/dbFunctions.R")
> source("../src/tableParsing.R")
> source("../src/tests.R")
> source("../src/main_Bioc.R")
> 
> if(!interactive()){    
+     chromosomes <- paste0("chr",c(11:22,"X","Y","MT"))
+     
+     # Create parallel structure here    
+     library(BiocParallel)    
+     register(MulticoreParam(workers = 15, stop.on.error = FALSE, log = TRUE), default = TRUE)
+ 
+     # Run on all 24 possible chromosomes at once
+     result <- bptry(bplapply(chromosomes,fillAllSamplesByChromosome,
+              dbConnection = db.hint,             
+              fimo = db.fimo,             
+              minid = "urinary_bladder_hint_20.minid",             
+              dbUser = "trena",             
+              dbTable = "urinary_bladder_hint_20",             
+              sourcePath = data.path,             
+              isTest = FALSE,             
+              method = "HINT"))    
+ }
############### LOG OUTPUT ###############
Task: 15
Node: 15
Timestamp: 2017-08-11 16:02:45
Success: TRUE
Task duration:
   user  system elapsed 
 17.644   0.572  18.217 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1645650 87.9    2637877 140.9  1850621 98.9
Vcells 1726298 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chrMT) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] No rows matching chrMT
############### LOG OUTPUT ###############
Task: 14
Node: 14
Timestamp: 2017-08-11 16:05:02
Success: TRUE
Task duration:
   user  system elapsed 
 88.000   5.680 154.593 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646636 88.0    2637877 140.9  1850621 98.9
Vcells 1728815 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chrY) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 35995 regions, 56180 hits for ENCSR813CKU
[1] 13856654 hits in 8523532 regions
############### LOG OUTPUT ###############
Task: 12
Node: 12
Timestamp: 2017-08-11 16:07:59
Success: TRUE
Task duration:
   user  system elapsed 
151.900  54.420 327.925 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646637 88.0    2637877 140.9  1850621 98.9
Vcells 1728816 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr22) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 302458 regions, 502907 hits for ENCSR813CKU
[1] 14359561 hits in 8825990 regions
############### LOG OUTPUT ###############
Task: 11
Node: 11
Timestamp: 2017-08-11 16:09:19
Success: TRUE
Task duration:
   user  system elapsed 
163.452  50.272 410.370 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646638 88.0    2637877 140.9  1850621 98.9
Vcells 1728817 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr21) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 212410 regions, 346651 hits for ENCSR813CKU
[1] 14706212 hits in 9038400 regions
############### LOG OUTPUT ###############
Task: 10
Node: 10
Timestamp: 2017-08-11 16:10:02
Success: TRUE
Task duration:
   user  system elapsed 
223.376  60.212 448.415 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646639 88.0    2637877 140.9  1850621 98.9
Vcells 1728818 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr20) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 396660 regions, 650219 hits for ENCSR813CKU
[1] 15356431 hits in 9435060 regions
############### LOG OUTPUT ###############
Task: 8
Node: 8
Timestamp: 2017-08-11 16:11:26
Success: TRUE
Task duration:
   user  system elapsed 
258.292  90.152 531.509 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646640 88.0    2637877 140.9  1850621 98.9
Vcells 1728819 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr18) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 309544 regions, 493723 hits for ENCSR813CKU
[1] 15850154 hits in 9744604 regions
############### LOG OUTPUT ###############
Task: 9
Node: 9
Timestamp: 2017-08-11 16:11:46
Success: TRUE
Task duration:
   user  system elapsed 
262.252  99.732 550.755 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646641 88.0    2637877 140.9  1850621 98.9
Vcells 1728820 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr19) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 624376 regions, 1070248 hits for ENCSR813CKU
[1] 16920402 hits in 10368980 regions
############### LOG OUTPUT ###############
Task: 6
Node: 6
Timestamp: 2017-08-11 16:12:30
Success: TRUE
Task duration:
   user  system elapsed 
302.164 101.480 595.431 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646642 88.0    2637877 140.9  1850621 98.9
Vcells 1728821 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr16) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 520568 regions, 869261 hits for ENCSR813CKU
[1] 17789663 hits in 10889548 regions
############### LOG OUTPUT ###############
Task: 5
Node: 5
Timestamp: 2017-08-11 16:12:54
Success: TRUE
Task duration:
   user  system elapsed 
 308.02  113.82  624.29 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646643 88.0    2637877 140.9  1850621 98.9
Vcells 1728822 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr15) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 468115 regions, 763563 hits for ENCSR813CKU
[1] 18553226 hits in 11357663 regions
############### LOG OUTPUT ###############
Task: 3
Node: 3
Timestamp: 2017-08-11 16:13:01
Success: TRUE
Task duration:
   user  system elapsed 
307.772 102.500 626.637 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646644 88.0    2637877 140.9  1850621 98.9
Vcells 1728823 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr13) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 346112 regions, 557536 hits for ENCSR813CKU
[1] 19110762 hits in 11703775 regions
############### LOG OUTPUT ###############
Task: 4
Node: 4
Timestamp: 2017-08-11 16:13:23
Success: TRUE
Task duration:
   user  system elapsed 
316.148 121.312 647.984 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646645 88.0    2637877 140.9  1850621 98.9
Vcells 1728824 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr14) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 460847 regions, 751179 hits for ENCSR813CKU
[1] 19861941 hits in 12164622 regions
############### LOG OUTPUT ###############
Task: 7
Node: 7
Timestamp: 2017-08-11 16:13:36
Success: TRUE
Task duration:
   user  system elapsed 
323.792 120.888 656.096 
Memory used:
          used (Mb) gc trigger  (Mb) max used (Mb)
Ncells 1646646 88.0    2637877 140.9  1850621 98.9
Vcells 1728825 13.2    3142662  24.0  2552061 19.5
Log messages:
stderr and stdout:
[1] ---- ENCSR813CKU (chr17) (1/1)
[1] "Data table read. Merging with Fimo..."
[1] "Merged. Now splitting table to regions and hits..."
[1] filling 722796 regions, 1197364 hits for ENCSR813CKU
[1] 21059305 hits in 12887418 regions
